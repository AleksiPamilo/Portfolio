---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import ProjectCard from '../components/ProjectCard.astro';

const allProjects = await getCollection('projects');
const projects = allProjects.sort(
	(a, b) => new Date(b.data.publishDate).valueOf() - new Date(a.data.publishDate).valueOf()
);

const skillGroups = [
    {
        type: 'core-stack',
        tags: ["C#", ".NET", "Vue.js", "TypeScript", "PostgreSQL", "SQL"]
    },
    {
        type: 'side-projects',
        tags: ["React", "Next.js", "Go", "Node.js", "Astro", "REST APIs"]
    },
    {
        type: 'infrastructure',
        tags: ["Docker", "Nginx", "Linux", "VPS", "GitHub Actions", "CI/CD", "Git"]
    },
    {
        type: 'security-ops',
        tags: ["SSH Hardening", "Fail2ban", "UFW", "TLS/HTTPS", "Observability", "Integration Testing"]
    }
];

const personStructuredData = JSON.stringify({
	'@context': 'https://schema.org',
	'@graph': [
		{
			'@type': 'Person',
			name: 'Aleksi Pamilo',
			url: 'https://pmlo.dev/',
			jobTitle: 'Software Engineer',
			description: 'Software engineer based in Finland focused on .NET, Vue, TypeScript.',
			sameAs: [
				'https://github.com/AleksiPamilo',
				'https://linkedin.com/in/aleksipamilo'
			]
		},
		{
			'@type': 'WebSite',
			name: 'Aleksi Pamilo Portfolio',
			url: 'https://pmlo.dev/'
		}
	]
});
---

<BaseLayout
	title="Aleksi Pamilo | Portfolio"
	description="Aleksi Pamilo portfolio: software engineer in Finland."
	image="/logo.png"
>
	<script slot="head" type="application/ld+json" set:html={personStructuredData}></script>
	<main class="relative z-1 mx-auto max-w-4xl px-6 pb-32 pt-28 md:pb-36 md:pt-32">
		<section class="reveal mb-24 md:mb-32">
			<div class="mb-[1.1rem] flex flex-col items-start justify-between gap-4 sm:flex-row sm:items-end">
				<div>
					<h1 class="m-0 text-[clamp(1.65rem,3.4vw,2.4rem)] leading-[1.12] tracking-[-0.02em]">Aleksi Pamilo Portfolio</h1>
				</div>
				<div class="flex gap-3 font-mono text-[0.72rem] tracking-[0.02em]">
					<a href="https://github.com/AleksiPamilo" target="_blank" rel="noreferrer" class="border px-2 py-1 text-(--muted) no-underline transition-colors duration-200 hover:bg-[color-mix(in_oklab,var(--accent-soft),transparent_60%)] hover:text-var(--text) border-color:var(--border) hover:border-color:color-mix(in_oklab,var(--accent),var(--border)_40%)">GitHub</a>
					<a href="https://linkedin.com/in/aleksipamilo" target="_blank" rel="noreferrer" class="border px-2 py-1 text-(--muted) no-underline transition-colors duration-200 hover:bg-[color-mix(in_oklab,var(--accent-soft),transparent_60%)] hover:text-var(--text) border-color:var(--border) hover:border-color:color-mix(in_oklab,var(--accent),var(--border)_40%)">LinkedIn</a>
				</div>
			</div>

			<div class="border-l-2 pl-3.5 text-[0.92rem] leading-[1.8] text-(--muted) border-left-color:color-mix(in_oklab,var(--accent),var(--border)_70%) [&_p]:mb-3.5 [&_span]:text-var(--text) [&_span]:underline [&_span]:underline-offset-[0.2em] [&_span]:decoration-[color-mix(in_oklab,var(--accent),transparent_34%)]">
				<p>
					I'm a software engineer based in Finland. Since last year, I've been balancing work as a developer with <span>.NET and Vue</span>
					while pursuing a BBA in Information Technology.
				</p>
				<p>
					In my own time, I build side projects where I can be a bit more opinionated about how things are made.
					I've realized I prefer simple, "boring" architecture over clever abstractions that are difficult to follow.
					I treat security and observability as baseline requirements because I enjoy building things that are easy to monitor and hard to break.
				</p>
				<p>
					Ultimately, I'm just a fan of clean documentation, readable code, and software that doesn't cause unnecessary drama.
				</p>
			</div>
		</section>

		<section class="reveal mb-24 md:mb-32">
			<div class="mb-8 mt-12 flex flex-col items-start justify-between gap-4 sm:flex-row sm:items-baseline">
				<h2 class="m-0 font-mono text-[0.72rem] uppercase tracking-[0.11em] text-(--muted)">Skills</h2>
				<p class="m-0 font-mono text-[0.72rem] text-(--muted)">Tools and technologies I use</p>
			</div>
			<div class="mt-6 flex flex-col gap-4">
				{skillGroups.map((group, groupIndex) => (
					<div class="flex flex-wrap gap-3 reveal" style={`--reveal-delay:${Math.min(groupIndex * 70, 280)}ms`}>
						{group.tags.map((tag, tagIndex) => (
							<span class={`skill-chip skill-chip--${group.type}`} style={`--chip-delay:${Math.min(tagIndex * 25, 200)}ms`}>
								{tag}
							</span>
						))}
					</div>
				))}
			</div>
		</section>

		<section class="reveal mb-24 md:mb-32">
			<div class="mb-8 flex flex-col items-start justify-between gap-4 sm:flex-row sm:items-baseline">
				<h2 class="m-0 font-mono text-[0.72rem] uppercase tracking-[0.11em] text-(--muted)">Selected Work</h2>
				<p class="m-0 font-mono text-[0.72rem] text-(--muted)">Problem-focused implementations</p>
			</div>
			<div class="flex flex-col gap-7 md:gap-8">
				{projects.map((project, index) => (
					<ProjectCard project={project} index={index} />
				))}
			</div>
		</section>
	</main>
</BaseLayout>